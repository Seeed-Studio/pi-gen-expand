# LXC container configuration for Recomputer R100x running SenseCAP
lxc.start.auto = 1

# Distribution configuration
lxc.include = /usr/share/lxc/config/common.conf
lxc.arch = aarch64

# Container specific configuration
lxc.apparmor.profile = unconfined
lxc.apparmor.allow_nesting = 1
lxc.rootfs.path = dir:/var/lib/lxc/SenseCAP/rootfs
lxc.uts.name = SenseCAP

# Network configuration
lxc.net.0.type = phys
lxc.net.0.link = eth0
lxc.net.0.flags = up
lxc.net.0.name = eth0
# Allow access to network devices
lxc.cgroup2.devices.allow = c 10:* rwm

lxc.mount.auto = sys:rw

lxc.cgroup2.devices.allow = c 89:* rwm
lxc.cgroup2.devices.allow = c 254:* rwm
lxc.cgroup2.devices.allow = c 153:* rwm
lxc.cgroup2.devices.allow = c 188:* rwm
lxc.cgroup2.devices.allow = c 204:* rwm
lxc.mount.entry = /dev/i2c-6 dev/i2c-1 none bind,optional,create=file
lxc.mount.entry = /dev/ttyAMA2 dev/RS485-1 none bind,optional,create=file
lxc.mount.entry = /dev/ttyAMA3 dev/RS485-2 none bind,optional,create=file
lxc.mount.entry = /dev/ttyAMA4 dev/RS485-3 none bind,optional,create=file
lxc.mount.entry = /dev/spidev1.1 dev/spidev0.1 none bind,optional,create=file
lxc.mount.entry = /sys/class/i2c-dev/i2c-6/device/6-0050/eeprom dev/eeprom none bind,optional,create=file

lxc.cgroup2.devices.allow = c 180:* rwm
lxc.mount.entry = /dev/cdc-wdm0 dev/cdc-wdm0 none bind,optional,create=file

lxc.mount.entry = /media media none bind,optional,create=dir
# Allow reboot and shutdown commands inside the container
lxc.mount.entry = /proc/sysrq-trigger proc/sysrq-trigger none bind,optional,create=file 0 0